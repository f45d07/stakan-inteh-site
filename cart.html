<!doctype html>
<html class="no-js" lang="zxx">

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <title>Корзина</title>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- <link rel="manifest" href="site.webmanifest"> -->
    <link rel="shortcut icon" type="image/x-icon" href="img/door.png">
    <!-- Place favicon.ico in the root directory -->

    <!-- CSS here -->
    <link rel="stylesheet" href="css/bootstrap.min.css">
    <link rel="stylesheet" href="css/owl.carousel.min.css">
    <link rel="stylesheet" href="css/magnific-popup.css">
    <link rel="stylesheet" href="css/font-awesome.min.css">
    <link rel="stylesheet" href="css/themify-icons.css">
    <link rel="stylesheet" href="css/nice-select.css">
    <link rel="stylesheet" href="css/flaticon.css">
    <link rel="stylesheet" href="css/gijgo.css">
    <link rel="stylesheet" href="css/animate.css">
    <link rel="stylesheet" href="css/slick.css">
    <link rel="stylesheet" href="css/slicknav.css">
    <link rel="stylesheet" href="https://ajax.googleapis.com/ajax/libs/jqueryui/1.11.2/themes/smoothness/jquery-ui.css">

    <link rel="stylesheet" href="css/style.css">

    <!-- <link rel="stylesheet" href="css/responsive.css"> -->
</head>

<body>
        <div id="blackout">
                <div id="box">
                  Popup window!<br>
                  <a href="#" class="close">Close window</a>
                </div>
              </div>

    <!-- header-start -->
    <header>
        <div class="header-area header-bg">
            <div id="sticky-header" class="main-header-area">
                <div class="container-fluid">
                    <div class="header_bottom_border">
                        <div class="row align-items-center">
                            <div class="col-xl-3 col-lg-2">
                                <div class="logo">
                                    <a href="index.html">
                                        <img src="img/the-doors.png" width="210" height="50" alt="">
                                    </a>
                                </div>
                            </div>
                            <div class="col-xl-4 col-lg-5">
                                <div class="main-menu  d-none d-lg-block">
                                    <nav>
                                        <ul id="navigation">
											<li><a href="index.html#about">О компании</a></li>
                                            <li><a href="index.html#catalogue">Каталог</a></li>                                            
                                            <li><a href="discounts.html">Акции</a></li>
                                            <li><a href="contacts.html">Контакты</a></li>
                                        </ul>
                                    </nav>
                                </div>
                            </div>
                            <div class="col-xl-2 col-lg-2">
                                <nav>
                                    <a href="cart.html" class="boxed-btn3-line mt-10 boxed-btn-fxd-w">Корзина (<span id="count-carts-items"></span>)</a>
                                </nav>
                            </div>
                            <div class="main-menu  d-none d-lg-block">
                                <nav>
                                        <ul><p>+ 7 (499) 863 - 93 - 43</ul>
                                        <ul><p>Крупнейший магазин дверей в России</ul>
                                </nav>
                            </div>
                            <div class="col-12">
                                <div class="mobile_menu d-block d-lg-none"></div>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
        </div>
    </header>
    
	<!-- КОНТАКТЫ -->
	<p><a name="catalogue"></a></p> 
    <div class="works_area">
        <div class="container">
            <div class="row">
                <div class="col-xl-12">
                    <div class="section_title mb-70">
                        <h3>Ваша корзина</h3>
                        <div id="no-carts-items">
                            <div class="cart mt-50">
                                У вас нет покупок.<br><br>
                                Все покупки находятся в разделе "Каталог".<br><br>
                                Если у вас есть какие-либо вопросы, вы можете написать нам в разделе "Контакты".
                            </div>
                            <a href="index.html#catalogue" onclick="" class="boxed-btn3-line mt-10 boxed-btn-fxd-w">Каталог</a>
                            <a href="contacts.html" onclick="" class="boxed-btn3-line mt-10 boxed-btn-fxd-w">Контакты</a>
                        </div>
                        <div id="full-cart-items">
                            <div class="cart mt-50">
                                    <table class="table cart-table" id="cart-table">
                                            <thead>
                                            <tr>
                                                <th scope="col">#</th>
                                                <th scope="col">Наименование</th>
                                                <th scope="col">Цена</th>
                                                <th scope="col">Действия</th>
                                            </tr>
                                            </thead>
                                            <tbody>                                          
                                            </tbody>
                                        </table>
                            </div> 
                            <a href="#" id="checkout-button" onclick="ShowLastStep()" class="boxed-btn3-line mt-10 boxed-btn-fxd-w">Оформить</a>   
                        </div>                    
                        
                        <form id="last-step-form" class="contact-form mt-50">
                            <div class="form-group">
                                <label for="NameInput">Ваше имя</label>
                                <input type="text" class="form-control" id="NameInput" placeholder="Имя">
                            </div>
                            <div class="form-group">
                                <label for="PhoneInput">Ваш телефон</label>
                                <input type="phone" class="form-control" id="PhoneInput" placeholder="+79001234567">
                            </div>
                            <button type="submit" onclick="Checkout()" class="btn btn-primary boxed-btn3-line">Завершить оформление</button>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- КОНЕЦ КОНТАКТОВ -->

    <!-- footer start -->
    <footer class="footer">
        <div class="query_area">
            <div class="container">
                <div class="bottom_border">
                        <div class="row align-items-center">
                                <div class="col-lg-6 col-md-6">
                                    <div class="query_text">
                                        <h3>Имеются вопросы? <br>
                                                Свяжитесь с нами</h3>
                                    </div>
                                </div>
                                <div class="col-lg-6 col-md-6">
                                    <div class="query_number">
                                        <h3>+ 7 (499) 863 - 93 - 43</h3>
                                        <h3>support@thedoors.com</h3>
                                    </div>
                                </div>
                            </div>
                </div>
                
            </div>
        </div>
        <div class="copy-right_text">
            <div class="container">
                <div class="row">
                    <div class="col-xl-12">
                        <p class="copy_right text-center">
Copyright &copy;<script>document.write(new Date().getFullYear());</script> All rights reserved | <a href="https://github.com/stankin/inet-2020/wiki/%D0%98%D0%94%D0%9C-20-01" target="_blank">TheDoors Team</a>
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </footer>
    <!--/ footer end  -->

    <!-- link that opens popup -->
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script src="https://static.codepen.io/assets/common/stopExecutionOnTimeout-de7e2ef6bfefd24b79a3f68b414b87b8db5b08439cac3f1012092b2290c719cd.js"></script> 
    
    <!--contact js-->

    <script src="js/discounts.js"></script>
    <script src="js/cart.js"></script>
    <script>
        function collision($div1, $div2) {
            var x1 = $div1.offset().left;
            var w1 = 40;
            var r1 = x1 + w1;
            var x2 = $div2.offset().left;
            var w2 = 40;
            var r2 = x2 + w2;

            if (r1 < x2 || x1 > r2)
                return false;
            return true;
        }
        // Fetch Url value 
        var getQueryString = function (parameter) {
            var href = window.location.href;
            var reg = new RegExp('[?&]' + parameter + '=([^&#]*)', 'i');
            var string = reg.exec(href);
            return string ? string[1] : null;
        };
       
        /* cart */

        function HideEmptyCartInfo() {
            var no_items = document.getElementById("no-carts-items");
            no_items.style.display = "block";
        }

        function ShowFullCartInfo() {
            var full_items = document.getElementById("full-cart-items");
            full_items.style.display = "block"; 
        }

        if (localStorage.getItem("cart") !== null && localStorage.getItem("cart").length > 2) {
            cart_items = JSON.parse(localStorage.cart);

            ShowFullCartInfo();
            
            HideEmptyCartInfo();          
            
            let index = 0;            
            var tableRef = document.getElementById("cart-table");

            for(item of cart_items) {
                var newRow = tableRef.insertRow(index + 1);
                var newCell_id = newRow.insertCell(0);
                var newCell_name = newRow.insertCell(1);
                var newCell_price = newRow.insertCell(2);
                var newCell_actions = newRow.insertCell(3);
                var item_id = document.createTextNode(index + 1);
                var item_name = document.createTextNode(item.item_name);
                var item_price = document.createTextNode(item.item_price);
                newCell_id.appendChild(item_id);
                newCell_name.appendChild(item_name);
                newCell_price.appendChild(item_price);
                newCell_actions.insertAdjacentHTML('beforeend', '<a href="javascript:DeleteItem(' + index + ')">Удалить</a>');

                index += 1;
            }
        }

        else {
            
        }

        function DeleteItem(index) {
            if (localStorage.getItem("cart") !== null) {

            cart_items = JSON.parse(localStorage.cart);

            const index_for_delete = index;

            console.log(cart_items);

            if (index_for_delete > -1) {
                cart_items.splice(index_for_delete, 1);
            }

            localStorage.cart = JSON.stringify(cart_items); 

            document.location.reload();

            }
        }

        function ShowLastStep() {
            document.getElementById("checkout-button").style.display = "none";
            document.getElementById("last-step-form").style.display = "block";
        }

        function Checkout() {
            localStorage.cart = JSON.stringify([]);
            document.location.reload();
        }

    </script>
</body>

</html>